# TEMPLATE: Add this workflow to tracked repos to trigger portfolio rebuilds on push
#
# To use:
# 1. Copy this file to the tracked repo: .github/workflows/notify-portfolio.yml
# 2. Add GitHub secret: PORTFOLIO_REBUILD_TOKEN (personal access token with repo scope)
# 3. Push to main branch - portfolio will rebuild automatically

name: Notify Portfolio

on:
  push:
    branches: [main, master]

jobs:
  notify:
    runs-on: ubuntu-latest

    steps:
      - name: Trigger Portfolio Rebuild
        run: |
          # Get repo name (e.g., "samifouad/gild")
          REPO_NAME="${{ github.repository }}"

          echo "ðŸ“¢ Notifying portfolio of changes to $REPO_NAME"

          # Trigger repository_dispatch event on portfolio repo
          curl -X POST \
            -H "Accept: application/vnd.github.v3+json" \
            -H "Authorization: token ${{ secrets.PORTFOLIO_REBUILD_TOKEN }}" \
            https://api.github.com/repos/samifouad/website/dispatches \
            -d "{\"event_type\":\"rebuild-portfolio\",\"client_payload\":{\"repo\":\"$REPO_NAME\"}}"

          echo "âœ… Portfolio notified successfully"
